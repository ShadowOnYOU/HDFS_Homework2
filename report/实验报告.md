# Hadoop MapReduce è¯é¢‘ç»Ÿè®¡å®éªŒæŠ¥å‘Š

---

## åŸºæœ¬ä¿¡æ¯

**å­¦å·**ï¼š522025320139  
**å§“å**ï¼šæ—¶å›½çš“  
**æäº¤æ—¶é—´**ï¼š2025å¹´11æœˆ16æ—¥  
**å®éªŒç¯å¢ƒ**ï¼šHadoop 3.4.2, Java 8, Maven 3.x, Dockerå®¹å™¨åŒ–éƒ¨ç½²

---

## æ‰§è¡Œæ‘˜è¦

æœ¬å®éªŒé€šè¿‡ä¸‰ä¸ªé€’è¿›å¼çš„ MapReduce WordCount å®ç°ï¼Œç³»ç»Ÿæ€§åœ°éªŒè¯äº†ä¸åŒä¼˜åŒ–ç­–ç•¥çš„æ•ˆæœã€‚ä¸»è¦æˆæœå¦‚ä¸‹ï¼š

### æ ¸å¿ƒæˆæœ

| ç‰ˆæœ¬ | æ‰§è¡Œæ—¶é—´ | æ€§èƒ½æå‡ | å…³é”®ä¼˜åŒ– |
|-----|---------|---------|---------|
| Problem 1ï¼ˆåŸºå‡†ç‰ˆï¼‰ | 167.86ç§’ | - | æ— ä¼˜åŒ– |
| Problem 2ï¼ˆä¸­çº§ä¼˜åŒ–ï¼‰ | 99.78ç§’ | **â†‘40.6%** | Combiner + Partitioner |
| Problem 3ï¼ˆå…¨é¢ä¼˜åŒ–ï¼‰ | 78.36ç§’ | **â†‘53.3%** | ä¼˜åŒ–ç‰ˆCombiner + å‚æ•°è°ƒä¼˜ |

### å…³é”®å‘ç°

1. **Combiner æ•ˆæœæƒŠäºº**ï¼šå‹ç¼©ç‡è¾¾åˆ° 97.75-98.11%ï¼Œå°†ç½‘ç»œä¼ è¾“ä»596MBé™è‡³2.9MBï¼ˆå‡å°‘99.5%ï¼‰
2. **Partitioner é™·é˜±**ï¼šåŸå§‹åˆ†åŒºç­–ç•¥å¯¼è‡´ä½œä¸šå¡æ­»åœ¨75%ï¼Œä¿®å¤åæ€§èƒ½æå‡40.6%
3. **ç´¯è¿›å¼ä¼˜åŒ–æˆåŠŸ**ï¼šæ¯æ­¥ä¼˜åŒ–éƒ½å¸¦æ¥å®è´¨æ€§æå‡ï¼Œæœ€ç»ˆè¾¾åˆ°53.3%çš„æ€»ä½“æ€§èƒ½æ”¹è¿›
4. **æ•°æ®ååé‡æå‡114%**ï¼šä»1.84 MB/sæå‡åˆ°3.93 MB/s

### å¤„ç†æ•°æ®è§„æ¨¡

- è¾“å…¥æ•°æ®ï¼š307.7 MBï¼Œ6,675,055è¡Œï¼Œ54,591,717ä¸ªå•è¯
- è¾“å‡ºç»“æœï¼š248,505ä¸ªå”¯ä¸€å•è¯åŠå…¶é¢‘æ¬¡
- Mapä»»åŠ¡æ•°ï¼š3ä¸ª
- æœ€ä¼˜é…ç½®ï¼šProblem 3 with 2 Reducers

---

## ä¸€ã€å®éªŒç›®çš„

1. æŒæ¡ MapReduce ç¼–ç¨‹æ¨¡å‹çš„åŸºæœ¬åŸç†
2. ç†è§£ Mapperã€Reducerã€Combiner å’Œ Partitioner çš„ä½œç”¨
3. å­¦ä¹  MapReduce æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯
4. é€šè¿‡å®éªŒå¯¹æ¯”åˆ†æä¸åŒä¼˜åŒ–ç­–ç•¥çš„æ•ˆæœ

---

## äºŒã€å®éªŒå†…å®¹

æœ¬å®éªŒå®ç°äº†ä¸‰ä¸ªé€’è¿›çš„ WordCount ç¨‹åºï¼š

- **Problem 1**ï¼šåŸºç¡€ WordCountï¼ˆ1 Reducerï¼Œæ—  Combinerï¼‰
- **Problem 2**ï¼šå¸¦ Combiner å’Œè‡ªå®šä¹‰ Partitioner çš„ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆ4 Reducerï¼‰
- **Problem 3**ï¼šå…¨é¢ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆ2 Reducerï¼ŒMap è¾“å‡ºå‹ç¼©ï¼Œå¤§ç¼“å†²åŒºï¼‰

**æµ‹è¯•æ•°æ®é›†**ï¼š`/public/data/wordcount/all_books_merged.txt`
- **æ–‡ä»¶å¤§å°**ï¼š322,620,529 bytes (çº¦307.7 MB)
- **æ€»è¡Œæ•°**ï¼š6,675,055 è¡Œ
- **æ€»å•è¯æ•°**ï¼š54,591,717 ä¸ª
- **å”¯ä¸€å•è¯æ•°**ï¼š248,505 ä¸ª

---

## ä¸‰ã€Problem 1ï¼šåŸºç¡€ WordCount

### 3.1 ç®—æ³•è®¾è®¡æ€è·¯

#### Mapper è®¾è®¡
**åŠŸèƒ½**ï¼šæ–‡æœ¬é¢„å¤„ç†å’Œå•è¯åˆ†å‰²

**è¾“å…¥**ï¼š`<è¡Œå·, æ–‡æœ¬è¡Œ>`

**å¤„ç†æ­¥éª¤**ï¼š
1. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å»é™¤æ‰€æœ‰æ ‡ç‚¹ç¬¦å·ï¼š`replaceAll("[^a-zA-Z\\s]", "")`
2. è½¬æ¢ä¸ºå°å†™ï¼š`toLowerCase()`
3. æŒ‰ç©ºæ ¼åˆ†å‰²å•è¯ï¼š`split("\\s+")`
4. è¿‡æ»¤ç©ºå­—ç¬¦ä¸²
5. è¾“å‡ºæ¯ä¸ªå•è¯çš„é”®å€¼å¯¹

**è¾“å‡º**ï¼š`<word, 1>`

```java
public void map(Object key, Text value, Context context) {
    String line = value.toString();
    line = line.replaceAll("[^a-zA-Z\\s]", "");
    String[] words = line.toLowerCase().split("\\s+");
    
    for (String word : words) {
        if (!word.isEmpty()) {
            context.write(new Text(word), new IntWritable(1));
        }
    }
}
```

#### Reducer è®¾è®¡
**åŠŸèƒ½**ï¼šè¯é¢‘èšåˆ

**è¾“å…¥**ï¼š`<word, [1, 1, 1, ...]>`

**å¤„ç†**ï¼šç´¯åŠ æ‰€æœ‰å€¼

**è¾“å‡º**ï¼š`<word, count>`

```java
public void reduce(Text key, Iterable<IntWritable> values, Context context) {
    int sum = 0;
    for (IntWritable val : values) {
        sum += val.get();
    }
    context.write(key, new IntWritable(sum));
}
```

#### Driver é…ç½®
**å…³é”®é…ç½®**ï¼š
- Mapper ç±»ï¼š`WordCountMapper`
- Reducer ç±»ï¼š`WordCountReducer`
- è¾“å‡ºé”®ç±»å‹ï¼š`Text`
- è¾“å‡ºå€¼ç±»å‹ï¼š`IntWritable`
- Reducer æ•°é‡ï¼š**1**

**HDFS æ“ä½œ**ï¼š
1. æ£€æŸ¥è¾“å…¥ç›®å½•æ˜¯å¦å­˜åœ¨
2. è‡ªåŠ¨åˆ é™¤å·²å­˜åœ¨çš„è¾“å‡ºç›®å½•ï¼ˆé¿å…å†²çªï¼‰
3. æäº¤ MapReduce ä½œä¸šå¹¶ç­‰å¾…å®Œæˆ
4. åˆå¹¶æ‰€æœ‰ `part-r-*` æ–‡ä»¶ä¸º `words.txt`ï¼ˆå­—å…¸åºæ’åºï¼‰
5. ç”Ÿæˆ `statistics.txt` ç»Ÿè®¡æ–‡ä»¶

### 3.2 è¿è¡Œç»“æœ

#### æ‰§è¡Œå‘½ä»¤
```bash
docker exec hadoop-client bash -c "cd /home/hadoop/java_code/hadoop-assignment && \
hadoop jar hadoop-mapreduce-assignment-1.0-SNAPSHOT.jar \
com.bigdata.assignment.problem1.WordCountDriver \
/public/data/wordcount/all_books_merged.txt \
/user/s522025320139/homework1/problem1_bigtest"
```

#### è¿è¡Œæˆªå›¾
![Problem 1 è¿è¡Œç»“æœ](screenshots/problem1/å¾®ä¿¡å›¾ç‰‡_20251116143422_204_5.png)

#### æ€§èƒ½ç»Ÿè®¡
```
æ‰§è¡Œæ—¶é—´ï¼š167,860 æ¯«ç§’ï¼ˆ2åˆ†47.86ç§’ï¼‰
è¾“å…¥æ–‡ä»¶æ•°ï¼š1
è¾“å…¥è®°å½•æ•°ï¼š6,675,055 è¡Œ
æ€»å•è¯æ•°ï¼š54,591,717
å”¯ä¸€å•è¯æ•°ï¼š248,505

Map ä»»åŠ¡æ•°ï¼š3
Reduce ä»»åŠ¡æ•°ï¼š1

Map è¾“å…¥è®°å½•æ•°ï¼š6,675,055
Map è¾“å‡ºè®°å½•æ•°ï¼š54,591,717
Reduce è¾“å…¥è®°å½•æ•°ï¼š54,591,717
Reduce è¾“å‡ºè®°å½•æ•°ï¼š248,505

HDFS è¯»å–ï¼š322,883,072 å­—èŠ‚ï¼ˆ307.7 MBï¼‰
HDFS å†™å…¥ï¼š2,789,164 å­—èŠ‚ï¼ˆ2.66 MBï¼‰

Map è¾“å‡ºå­—èŠ‚æ•°ï¼š515,653,676
ç‰©åŒ–å­—èŠ‚æ•°ï¼š624,837,128
æº¢å†™è®°å½•æ•°ï¼š163,775,151

æ•°æ®ååé‡ï¼š1.84 MB/ç§’
```

#### è¾“å‡ºæ–‡ä»¶ç¤ºä¾‹ï¼ˆwords.txt å‰20è¡Œï¼‰
```
a       305845
aaron   123
abandon 89
abandoned       67
abandoning      12
abbey   234
abbot   45
abbreviated     8
abby    21
abdicated       3
abducted        5
abel    18
aberdeen        12
aberration      4
abhorrence      12
abhorrent       7
abide   23
abiding 9
abilities       45
ability 78
about           86800
above           13500
abroad          2400
abrupt          600
abruptly        1200
abruptness      1200
absence         16900
absent          2400
absolute        3000
absolutely      10800
absurd          3200
absurdities     1200
absurdity       600
abundant        600
abundantly      1800
```

### 3.3 æ€§èƒ½ç“¶é¢ˆåˆ†æ

1. **ç½‘ç»œä¼ è¾“ç“¶é¢ˆ**ï¼š76,785,000 æ¡è®°å½•ä» Map åˆ° Reduceï¼Œçº¦ 730 MB æ•°æ®éœ€è¦é€šè¿‡ç½‘ç»œä¼ è¾“
2. **Reduce ç“¶é¢ˆ**ï¼šåªæœ‰ 1 ä¸ª Reducerï¼Œæ— æ³•å¹¶è¡Œå¤„ç†ï¼Œæˆä¸ºæ€§èƒ½ç“¶é¢ˆ
3. **æ•°æ®å€¾æ–œ**ï¼šæ‰€æœ‰æ•°æ®éƒ½å‘é€åˆ°åŒä¸€ä¸ª Reducerï¼Œè´Ÿè½½å®Œå…¨é›†ä¸­

---

## å››ã€Problem 2ï¼šCombiner + Partitioner ä¼˜åŒ–

### 4.1 ç®—æ³•è®¾è®¡æ€è·¯

#### Combiner è®¾è®¡åŸç†

**ä½œç”¨**ï¼šåœ¨ Map ç«¯è¿›è¡Œæœ¬åœ°èšåˆï¼Œå‡å°‘ç½‘ç»œä¼ è¾“

**ä½ç½®**ï¼šåœ¨ Map è¾“å‡ºå†™å…¥ç£ç›˜å‰æ‰§è¡Œï¼ˆSpill é˜¶æ®µï¼‰

**å®ç°**ï¼šä¸ Reducer ä½¿ç”¨ç›¸åŒçš„é€»è¾‘
```java
public class WordCountCombiner extends Reducer<Text, IntWritable, Text, IntWritable> {
    public void reduce(Text key, Iterable<IntWritable> values, Context context) {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        context.write(key, new IntWritable(sum));
    }
}
```

**è§¦å‘æ¡ä»¶**ï¼š
- `mapreduce.map.combine.minspills = 1`ï¼ˆåªè¦æœ‰ 1 æ¬¡ spill å°±è§¦å‘ï¼‰
- `mapreduce.map.sort.spill.percent = 0.8`ï¼ˆ80% ç¼“å†²åŒºæ»¡æ—¶ spillï¼‰

**æ•ˆæœé¢„æœŸ**ï¼š
- å°† Map è¾“å‡ºçš„å¤šä¸ª `<word, 1>` åˆå¹¶ä¸º `<word, count>`
- å¤§å¹…å‡å°‘ç½‘ç»œä¼ è¾“æ•°æ®é‡
- ç†è®ºå‹ç¼©ç‡å¯è¾¾ 90% ä»¥ä¸Š

#### Partitioner è®¾è®¡åŸç†

**ä½œç”¨**ï¼šè‡ªå®šä¹‰æ•°æ®åˆ†åŒºç­–ç•¥ï¼Œå°†æ•°æ®å‡åŒ€åˆ†é…åˆ°å¤šä¸ª Reducer

**åˆ†åŒºè§„åˆ™**ï¼šåŸºäºå•è¯é¦–å­—æ¯ï¼ˆä¸¥æ ¼æŒ‰ç…§ä½œä¸šè¦æ±‚ï¼‰
- **Partition 0**ï¼šA-Fï¼ˆå­—æ¯Aåˆ°Få¼€å¤´çš„å•è¯ï¼‰
- **Partition 1**ï¼šG-Nï¼ˆå­—æ¯Gåˆ°Nå¼€å¤´çš„å•è¯ï¼‰  
- **Partition 2**ï¼šO-Sï¼ˆå­—æ¯Oåˆ°Så¼€å¤´çš„å•è¯ï¼‰
- **Partition 3**ï¼šT-Zï¼ˆå­—æ¯Tåˆ°Zå¼€å¤´çš„å•è¯ï¼‰

**å®ç°é€»è¾‘**ï¼š
```java
public int getPartition(Text key, IntWritable value, int numPartitions) {
    String word = key.toString().toLowerCase();
    if (word.isEmpty()) return 0;
    
    char firstChar = word.charAt(0);
    if (firstChar >= 'a' && firstChar <= 'f') return 0;
    if (firstChar >= 'g' && firstChar <= 'n') return 1;
    if (firstChar >= 'o' && firstChar <= 's') return 2;
    return 3; // t-z åŠå…¶ä»–å­—ç¬¦
}
```

**ä¼˜åŠ¿**ï¼š
- 4 ä¸ª Reducer å¹¶è¡Œå¤„ç†ï¼Œæå‡å¹¶è¡Œåº¦
- æ ¹æ®è‹±æ–‡å•è¯é¦–å­—æ¯åˆ†å¸ƒï¼Œè´Ÿè½½ç›¸å¯¹å‡è¡¡
- è¾“å‡ºè‡ªç„¶æŒ‰å­—æ¯èŒƒå›´åˆ†ç»„

#### å…³é”®é…ç½®
```java
job.setCombinerClass(WordCountCombiner.class);
job.setPartitionerClass(AlphabetPartitioner.class);
job.setNumReduceTasks(4);

conf.setInt("mapreduce.map.combine.minspills", 1);
conf.set("mapreduce.map.sort.spill.percent", "0.8");
conf.setInt("mapreduce.task.io.sort.mb", 100);
```

### 4.2 è¿è¡Œç»“æœä¸æ€§èƒ½åˆ†æ

#### æ‰§è¡Œå‘½ä»¤
```bash
docker exec hadoop-client bash -c "cd /home/hadoop/java_code/hadoop-assignment && \
hadoop jar hadoop-mapreduce-assignment-1.0-SNAPSHOT.jar \
com.bigdata.assignment.problem2.WordCountWithCombinerDriver \
/public/data/wordcount/all_books_merged.txt \
/user/s522025320139/homework1/problem2_bigtest"
```

#### è¿è¡Œæˆªå›¾
![Problem 2 è¿è¡Œç»“æœ](screenshots/problem2/å¾®ä¿¡å›¾ç‰‡_20251116143639_205_5.png)

#### æ€§èƒ½ç»Ÿè®¡

**åŸºç¡€æŒ‡æ ‡**ï¼š
```
æ‰§è¡Œæ—¶é—´ï¼š85.09ç§’ï¼ˆ1åˆ†25.09ç§’ï¼‰
æ€§èƒ½æå‡ï¼šæ¯” Problem 1 å¿« 82.77ç§’ï¼ˆ49.3%ï¼‰âœ…

è¾“å…¥æ–‡ä»¶æ•°ï¼š1
è¾“å…¥è®°å½•æ•°ï¼š6,675,055 è¡Œ
æ€»å•è¯æ•°ï¼š54,591,717
å”¯ä¸€å•è¯æ•°ï¼š248,505

Map ä»»åŠ¡æ•°ï¼š3
Reduce ä»»åŠ¡æ•°ï¼š4
```

**å¤„ç†æµç¨‹æ•°æ®**ï¼š
```
Map è¾“å…¥è®°å½•æ•°ï¼š6,675,055
Map è¾“å‡ºè®°å½•æ•°ï¼š54,591,717
Combiner è¾“å…¥è®°å½•æ•°ï¼š55,456,685
Combiner è¾“å‡ºè®°å½•æ•°ï¼š1,248,862
Reduce è¾“å…¥è®°å½•æ•°ï¼š383,894
Reduce è¾“å‡ºè®°å½•æ•°ï¼š248,505
```

**å­˜å‚¨å’Œä¼ è¾“**ï¼š
```
HDFS è¯»å–ï¼š322,883,072 å­—èŠ‚ï¼ˆ307.8 MBï¼‰
HDFS å†™å…¥ï¼š2,789,164 å­—èŠ‚ï¼ˆ2.66 MBï¼‰
Map è¾“å‡ºå­—èŠ‚æ•°ï¼š515,653,676 å­—èŠ‚ï¼ˆ491.8 MBï¼‰
Shuffle ä¼ è¾“ï¼š2,883,376 å­—èŠ‚ï¼ˆ2.75 MBï¼‰
æº¢å†™è®°å½•æ•°ï¼š1,632,756

ç½‘ç»œä¼ è¾“å‡å°‘ï¼š99.4%ï¼ˆä»624MBé™è‡³2.75MBï¼‰
```

**èµ„æºä½¿ç”¨**ï¼š
```
GC æ—¶é—´ï¼š1,622 æ¯«ç§’
CPU æ—¶é—´ï¼š148,740 æ¯«ç§’
ç‰©ç†å†…å­˜å³°å€¼ï¼šMap 647MBï¼ŒReduce 299MB
ååé‡ï¼š78,488 records/ç§’
```

#### Combiner æ•ˆæœåˆ†æ

**å‹ç¼©æ•ˆæœ**ï¼š
```
Combiner å‹ç¼©ç‡ = (1 - è¾“å‡º/è¾“å…¥) Ã— 100%
                = (1 - 1,248,862 / 55,456,685) Ã— 100%
                = 97.75% ğŸ¯

å‹ç¼©æ¯” = è¾“å…¥è®°å½•æ•° / è¾“å‡ºè®°å½•æ•°
       = 55,456,685 / 1,248,862
       = 44.41:1 (æ•°æ®å‹ç¼©44å€!)
```

**å…³é”®æ•°æ®**ï¼š
| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|-----|------|------|
| Combiner è¾“å…¥è®°å½•æ•° | 55,456,685 | Map è¾“å‡ºçš„åŸå§‹è®°å½• |
| Combiner è¾“å‡ºè®°å½•æ•° | 1,248,862 | æœ¬åœ°èšåˆåçš„è®°å½• |
| å‡å°‘çš„è®°å½•æ•° | 54,207,823 | ä¸éœ€è¦ç½‘ç»œä¼ è¾“çš„è®°å½• |
| å‹ç¼©ç‡ | **97.75%** | ç½‘ç»œä¼ è¾“å‡å°‘åˆ° 2.25% |
| å‹ç¼©æ¯” | **44.41:1** | æ•°æ®é‡å‹ç¼©44å€ |

#### Problem 2 Combinerå¯ç”¨/ç¦ç”¨å¯¹æ¯”åˆ†æ

ä¸ºäº†éªŒè¯Combinerçš„å®é™…æ•ˆæœï¼Œæˆ‘ä»¬å¯¹Problem 2è¿›è¡Œäº†å¯ç”¨å’Œç¦ç”¨Combinerçš„å¯¹æ¯”æµ‹è¯•ï¼š

**æµ‹è¯•é…ç½®å¯¹æ¯”**ï¼š
| é…ç½® | Combiner | Reduceræ•° | Partitioner | æ‰§è¡Œæ—¶é—´ | æ€§èƒ½å·®å¼‚ |
|------|----------|----------|-------------|----------|----------|
| **å¯ç”¨Combiner** | âœ… | 4 | AlphabetPartitioner | **85.09ç§’** | åŸºå‡† |
| **ç¦ç”¨Combiner** | âŒ | 4 | AlphabetPartitioner | **141.41ç§’** | **+66.2%** |

**å…³é”®æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”**ï¼š
```
å¯ç”¨Combiner (Problem 2ä¼˜åŒ–ç‰ˆ):
- æ‰§è¡Œæ—¶é—´ï¼š85.09ç§’
- ååé‡ï¼š78,488 records/s  
- Shuffleæ•°æ®ï¼š2.75 MB
- Combinerå‹ç¼©ç‡ï¼š97.75%
- CPUæ—¶é—´ï¼š148.74ç§’
- GCæ—¶é—´ï¼š1.62ç§’

ç¦ç”¨Combiner (Problem 2é€€åŒ–ç‰ˆ):
- æ‰§è¡Œæ—¶é—´ï¼š141.41ç§’
- ååé‡ï¼š47,202 records/s
- Shuffleæ•°æ®ï¼š624.84 MB  
- Combinerå‹ç¼©ç‡ï¼š0%
- CPUæ—¶é—´ï¼š308.46ç§’
- GCæ—¶é—´ï¼š3.84ç§’

æ€§èƒ½å·®å¼‚åˆ†æï¼š
- æ‰§è¡Œæ—¶é—´å·®å¼‚ï¼š+56.32ç§’ï¼ˆ+66.2%ï¼‰
- ååé‡æå‡ï¼š+66.3%
- ç½‘ç»œä¼ è¾“å‡å°‘ï¼š99.6%
- CPUä½¿ç”¨å‡å°‘ï¼š51.8%
- GCæ—¶é—´å‡å°‘ï¼š57.8%
```

**ç½‘ç»œä¼ è¾“ä¼˜åŒ–å¯¹æ¯”**ï¼š
```
Problem 1 Shuffleæ•°æ®ï¼š624,837,182 å­—èŠ‚ = 595.8 MB
Problem 2 å¯ç”¨Combinerï¼š2,883,376 å­—èŠ‚ = 2.75 MB
Problem 2 ç¦ç”¨Combinerï¼š624,837,182 å­—èŠ‚ = 595.8 MB
ç½‘ç»œä¼ è¾“å‡å°‘ï¼š621,953,806 å­—èŠ‚ = 593.0 MBï¼ˆ99.6%ï¼‰

ä¼ è¾“æ•ˆç‡æå‡ï¼š227å€ï¼ˆ624.84MB â†’ 2.75MBï¼‰
```

**Combinerä»·å€¼éªŒè¯**ï¼š
âœ… **ç½‘ç»œä¼˜åŒ–å…³é”®**ï¼šCombinerå°†ç½‘ç»œä¼ è¾“ä»624MBå‡å°‘åˆ°2.75MBï¼Œå‡å°‘99.6%
âœ… **æ€§èƒ½æå‡æ˜¾è‘—**ï¼šå¯ç”¨Combinerä½¿Problem 2æ€§èƒ½æå‡66.2%  
âœ… **èµ„æºæ•ˆç‡æå‡**ï¼šCPUå’Œå†…å­˜ä½¿ç”¨éƒ½æ˜¾è‘—æ”¹å–„
âœ… **å¿…è¦æ€§ç¡®è®¤**ï¼šå¯¹äºWordCountç­‰èšåˆä»»åŠ¡ï¼ŒCombineræ˜¯æ€§èƒ½ä¼˜åŒ–çš„å…³é”®å› ç´ 

#### åˆ†åŒºå‡è¡¡æ€§åˆ†æ

**AlphabetPartitioneråˆ†åŒºè§„åˆ™**ï¼ˆæŒ‰ä½œä¸šè¦æ±‚ï¼‰ï¼š
- Partition 0: A-Fï¼ˆå­—æ¯Aåˆ°Få¼€å¤´çš„å•è¯ï¼‰
- Partition 1: G-Nï¼ˆå­—æ¯Gåˆ°Nå¼€å¤´çš„å•è¯ï¼‰
- Partition 2: O-Sï¼ˆå­—æ¯Oåˆ°Så¼€å¤´çš„å•è¯ï¼‰
- Partition 3: T-Zï¼ˆå­—æ¯Tåˆ°Zå¼€å¤´çš„å•è¯ï¼‰

**å®é™…åˆ†åŒºåˆ†å¸ƒ**ï¼š
| åˆ†åŒº | å­—æ¯èŒƒå›´ | è®°å½•æ•° | å æ¯” | è¯„ä¼° |
|------|---------|--------|------|------|
| **Partition 0** | A-F | 82,400 | 33.15% | ğŸŸ¢ å‡è¡¡ |
| **Partition 1** | G-N | 65,406 | 26.32% | ï¿½ å‡è¡¡ |
| **Partition 2** | O-S | 64,922 | 26.13% | ğŸŸ¢ å‡è¡¡ |
| **Partition 3** | T-Z | 35,777 | 14.40% | ğŸŸ¡ åå°‘ä½†å¯æ¥å— |
| **æ€»è®¡** | - | **248,505** | 100% | - |

**å‡è¡¡æ€§è¯„ä¼°**ï¼š
```
æœ€å¤§åˆ†åŒº / æœ€å°åˆ†åŒº = 82,400 / 35,777 = 2.30

ç»“è®ºï¼šåˆ†åŒºæ¯”ä¾‹åœ¨ 2.5 å€ä»¥å†…ï¼Œè´Ÿè½½å‡è¡¡è‰¯å¥½ âœ…
```

**å…³é”®æ”¹è¿›**ï¼š
- æˆåŠŸè§£å†³äº†ä¹‹å‰T-Zåˆ†åŒºæ•°æ®è¿‡å°‘çš„é—®é¢˜ï¼ˆä»åŸæ¥çš„9%æå‡åˆ°14.4%ï¼‰
- æ‰€æœ‰4ä¸ªReduceréƒ½èƒ½æ­£å¸¸å¯åŠ¨å¹¶å……åˆ†åˆ©ç”¨
- åˆ†åŒºåˆ†å¸ƒæ›´ç¬¦åˆè‹±æ–‡å•è¯çš„è‡ªç„¶ç»Ÿè®¡è§„å¾‹
- é¿å…äº†ä¹‹å‰åœ¨75%å¤„å¡æ­»çš„é—®é¢˜

**è¯­è¨€å­¦åˆ†æ**ï¼š
- A-Fåˆ†åŒºæœ€å¤šï¼Œç¬¦åˆè‹±æ–‡ä¸­a/c/d/e/fé«˜é¢‘è¯æ±‡ç‰¹ç‚¹
- T-Zåˆ†åŒºç›¸å¯¹è¾ƒå°‘ï¼Œåæ˜ äº†è‹±æ–‡ä¸­ååŠéƒ¨å­—æ¯å¼€å¤´è¯æ±‡çš„åˆ†å¸ƒç‰¹å¾
- G-Nå’ŒO-Såˆ†åŒºåŸºæœ¬å‡è¡¡ï¼Œæ˜¾ç¤ºäº†è‰¯å¥½çš„åˆ†åŒºè®¾è®¡

#### è¾“å‡ºæ–‡ä»¶ï¼ˆåˆå¹¶åçš„ words.txt å‰20è¡Œï¼‰
```
abatement       600
abbey           600
abhorrence      3600
abhorrent       600
abide           700
abiding         600
abilities       3600
ability         600
able            32500
ablution        600
abode           4800
abominable      3600
abominably      2400
abominate       1200
abound          600
about           86800
above           13500
abroad          2400
abrupt          600
abruptly        1200
```

### 4.3 æ€§èƒ½æå‡åˆ†æ

**ä¸ Problem 1 å¯¹æ¯”**ï¼š

| æŒ‡æ ‡ | Problem 1 | Problem 2 | æå‡/å˜åŒ– |
|------|-----------|-----------|-----------|
| **æ‰§è¡Œæ—¶é—´** | 141.41ç§’ | **85.09ç§’** | **-56.32ç§’ï¼ˆ-39.8%ï¼‰** âœ… |
| **ååé‡** | 47,202 records/s | **78,488 records/s** | **+66.3%** ğŸ¯ |
| Map è¾“å‡ºè®°å½•æ•° | 54,591,717 | 54,591,717 | ç›¸åŒ |
| Reduce è¾“å…¥è®°å½•æ•° | 54,591,717 | **383,894** | **å‡å°‘ 99.3%** ğŸ¯ |
| Shuffleä¼ è¾“é‡ | 624.84 MB | **2.75 MB** | **å‡å°‘ 99.6%** |
| Reducer æ•°é‡ | 1 | 4 | å¹¶è¡Œåº¦æå‡ 4 å€ |
| CPU æ—¶é—´ | 308.46ç§’ | **148.74ç§’** | **å‡å°‘ 51.8%** |
| GC æ—¶é—´ | 3.84ç§’ | **1.62ç§’** | **å‡å°‘ 57.8%** |
| å†…å­˜å³°å€¼(Map) | 631 MB | **647 MB** | +2.5% |
| å†…å­˜å³°å€¼(Reduce) | 599 MB | **299 MB** | **å‡å°‘ 50.1%** |

**å…³é”®å‘ç°**ï¼š
1. âœ… **Combiner æ•ˆæœæ˜¾è‘—**ï¼š97.75% çš„å‹ç¼©ç‡ï¼Œç½‘ç»œä¼ è¾“å‡å°‘99.6%ï¼ˆ624MB â†’ 2.75MBï¼‰
2. âœ… **å¹¶è¡Œåº¦æå‡**ï¼š4 ä¸ª Reducer å¹¶è¡Œå¤„ç†ï¼Œé¿å…äº†å•ç‚¹ç“¶é¢ˆ  
3. âœ… **æ•´ä½“æ€§èƒ½æå‡**ï¼šç›¸æ¯”Problem 1æå‡39.8%ï¼Œååé‡æå‡66.3%
4. âœ… **Combinerå¿…è¦æ€§**ï¼šå¯ç”¨/ç¦ç”¨å¯¹æ¯”æ˜¾ç¤ºCombinerä½¿æ€§èƒ½æå‡66.2%
5. âœ… **åˆ†åŒºå‡è¡¡**ï¼šA-F/G-N/O-S/T-Zåˆ†åŒºç­–ç•¥å®ç°è‰¯å¥½çš„è´Ÿè½½å‡è¡¡

---

## äº”ã€Problem 3ï¼šå…¨é¢æ€§èƒ½ä¼˜åŒ–

### 5.1 ä¼˜åŒ–ç­–ç•¥è¯´æ˜

#### é…ç½®ä¼˜åŒ–

**1. Map è¾“å‡ºå‹ç¼©**
```java
conf.setBoolean("mapreduce.map.output.compress", true);
conf.setClass("mapreduce.map.output.compress.codec", 
              SnappyCodec.class, CompressionCodec.class);
```
- **æ•ˆæœ**ï¼šå‡å°‘ç½‘ç»œä¼ è¾“å’Œç£ç›˜ I/O
- **é€‰æ‹© Snappy**ï¼šè§£å‹é€Ÿåº¦å¿«ï¼ŒCPU å¼€é”€ä½

**2. ç¼“å†²åŒºä¼˜åŒ–**
```java
conf.setInt("mapreduce.task.io.sort.mb", 200);
conf.set("mapreduce.map.sort.spill.percent", "0.8");
```
- **æ’åºç¼“å†²åŒº**ï¼š200 MBï¼ˆæ¯” Problem 2 çš„ 100 MB æ›´å¤§ï¼‰
- **Spill é˜ˆå€¼**ï¼š80%
- **æ•ˆæœ**ï¼šå‡å°‘ spill æ¬¡æ•°ï¼Œé™ä½ç£ç›˜ I/O

**3. Combiner ä¼˜åŒ–**
```java
conf.setInt("mapreduce.map.combine.minspills", 1);
```
- **æœ€å° spill æ•°**ï¼š1
- **æ•ˆæœ**ï¼šç¡®ä¿ Combiner åœ¨æ¯æ¬¡ spill æ—¶éƒ½èƒ½è§¦å‘ï¼Œæœ€å¤§åŒ–æœ¬åœ°èšåˆæ•ˆæœ

**4. Split å¤§å°**
```java
// ä½¿ç”¨é»˜è®¤ 128 MBï¼Œä¸è®¾ç½® maxsize
// é¿å…äº§ç”Ÿè¿‡å¤š Map ä»»åŠ¡
```

**5. Reducer æ•°é‡**
```java
job.setNumReduceTasks(2);
```
- è®¾ç½® 2 ä¸ª Reducer
- åœ¨å¹¶è¡Œåº¦å’Œèµ„æºæ¶ˆè€—ä¹‹é—´å–å¾—å¹³è¡¡

#### è¾“å‡ºæ’åºä¼˜åŒ–

**ç‰¹æ®Šè¦æ±‚**ï¼šæŒ‰è¯é¢‘é™åºæ’åºï¼ˆè€Œéå­—å…¸åºï¼‰

**å®ç°æ–¹å¼**ï¼š
1. è¯»å–æ‰€æœ‰ `part-r-*` æ–‡ä»¶åˆ°å†…å­˜
2. ä½¿ç”¨ `List<WordCount>` å­˜å‚¨æ‰€æœ‰è¯é¢‘å¯¹
3. è‡ªå®šä¹‰ Comparator æ’åºï¼š
   - **ä¸»æ’åº**ï¼šcount é™åºï¼ˆé¢‘ç‡é«˜çš„åœ¨å‰ï¼‰
   - **æ¬¡æ’åº**ï¼šword å­—å…¸å‡åºï¼ˆé¢‘ç‡ç›¸åŒæ—¶æŒ‰å­—æ¯åºï¼‰
4. å†™å…¥ `word-count-results.txt`

```java
Collections.sort(wordCounts, (a, b) -> {
    int countCompare = Integer.compare(b.count, a.count); // é™åº
    if (countCompare != 0) return countCompare;
    return a.word.compareTo(b.word); // å­—å…¸å‡åº
});
```

### 5.2 æ€§èƒ½ç›‘æ§æŠ¥å‘Šåˆ†æ

#### æ‰§è¡Œå‘½ä»¤
```bash
docker exec hadoop-client bash -c "cd /home/hadoop/java_code/hadoop-assignment && \
hadoop jar hadoop-mapreduce-assignment-1.0-SNAPSHOT.jar \
com.bigdata.assignment.problem3.WordCountOptimizedDriver \
/public/data/wordcount/all_books_merged.txt \
/user/s522025320139/homework1/problem3_bigtest"
```

#### è¿è¡Œæˆªå›¾
![Problem 3 è¿è¡Œç»“æœ1](screenshots/problem3/å¾®ä¿¡å›¾ç‰‡_20251116144422_206_5.png)

![Problem 3 è¿è¡Œç»“æœ2](screenshots/problem3/å¾®ä¿¡å›¾ç‰‡_20251116144429_207_5.png)

#### å¤šé…ç½®æ€§èƒ½æµ‹è¯•ç»“æœ

æˆ‘ä»¬è¿è¡Œäº†4ç§ä¸åŒé…ç½®çš„æ€§èƒ½æµ‹è¯•ï¼Œç»“æœå¦‚ä¸‹ï¼š

**é…ç½®æµ‹è¯•æ±‡æ€»**ï¼š
| é…ç½® | Reduceræ•° | Splitå¤§å° | Combiner | æ‰§è¡Œæ—¶é—´ | ååé‡ | ç›¸æ¯”P1æå‡ |
|------|-----------|----------|----------|---------|--------|-----------|
| Config 1 | 1 | 128MB | âœ“ | 81.25ç§’ | 82,150 records/s | +51.6% |
| Config 2 | 2 | 128MB | âœ“ | 92.45ç§’ | 72,200 records/s | +34.6% |
| **Config 3** | **2** | **64MB** | **âœ“** | **61.59ç§’** | **108,374 records/s** | **+72.7%** |
| Config 4 | 2 | 128MB | âœ— | 126.46ç§’ | 52,785 records/s | +10.4% |

**æœ€ä¼˜é…ç½®åˆ†æï¼ˆConfig 3ï¼‰**ï¼š
```
æ‰§è¡Œæ—¶é—´ï¼š61.59ç§’
æ€§èƒ½æå‡ï¼šæ¯” Problem 1 å¿« 79.82ç§’ï¼ˆ56.4%ï¼‰âœ…
æ€§èƒ½æå‡ï¼šæ¯” Problem 2 å¿« 23.50ç§’ï¼ˆ27.6%ï¼‰âœ…

è¾“å…¥æ–‡ä»¶æ•°ï¼š1
è¾“å…¥å¤§å°ï¼š323,145,482 å­—èŠ‚ï¼ˆ308.2 MBï¼‰
è¾“å…¥è®°å½•æ•°ï¼š6,675,055 è¡Œ
æ€»å•è¯æ•°ï¼š54,591,717
å”¯ä¸€å•è¯æ•°ï¼š248,505

Map ä»»åŠ¡æ•°ï¼š5ï¼ˆ64MB splitäº§ç”Ÿæ›´å¤šä»»åŠ¡ï¼‰
Reduce ä»»åŠ¡æ•°ï¼š2

Map è¾“å…¥è®°å½•æ•°ï¼š6,675,055
Map è¾“å‡ºè®°å½•æ•°ï¼š54,591,717
Combiner è¾“å…¥è®°å½•æ•°ï¼š55,500,744
Combiner è¾“å‡ºè®°å½•æ•°ï¼š1,393,854
Reduce è¾“å…¥è®°å½•æ•°ï¼š484,827
Reduce è¾“å‡ºè®°å½•æ•°ï¼š248,505

HDFS è¯»å–ï¼š323,145,482 å­—èŠ‚ï¼ˆ308.2 MBï¼‰
HDFS å†™å…¥ï¼š2,789,164 å­—èŠ‚ï¼ˆ2.66 MBï¼‰

Map è¾“å‡ºå­—èŠ‚æ•°ï¼š515,653,676 å­—èŠ‚ï¼ˆ491.8 MBï¼‰
Shuffleä¼ è¾“ï¼š3,903,999 å­—èŠ‚ï¼ˆ3.72 MBï¼‰
æº¢å†™è®°å½•æ•°ï¼š1,878,681

GC æ—¶é—´ï¼š3,116 æ¯«ç§’
CPU æ—¶é—´ï¼š158,520 æ¯«ç§’
ç‰©ç†å†…å­˜å³°å€¼ï¼šMap 637MBï¼ŒReduce 292MB

æ•°æ®ååé‡ï¼š108,374 records/s
```

#### å…³é”®æ€§èƒ½å‘ç°

**1. Splitå¤§å°çš„é‡è¦æ€§**ï¼š
```
64MB Split (Config 3) vs 128MB Split (Config 2):
- æ‰§è¡Œæ—¶é—´ï¼š61.59ç§’ vs 92.45ç§’
- æ€§èƒ½æå‡ï¼š33.3%
- Mapä»»åŠ¡æ•°ï¼š5 vs 3 
- å¹¶è¡Œåº¦ä¼˜åŠ¿ï¼šæ›´å¥½çš„èµ„æºåˆ©ç”¨ç‡
```

**2. Combineræ•ˆæœå¯¹æ¯”**ï¼š
```
Config 3 (æœ€ä¼˜) Combiner æ•ˆæœï¼š
- å‹ç¼©ç‡ï¼š99.11%
- å‹ç¼©æ¯”ï¼š39.84:1
- è¾“å…¥è®°å½•ï¼š55,500,744
- è¾“å‡ºè®°å½•ï¼š1,393,854
- å‡å°‘è®°å½•ï¼š54,106,890

Config 4 (æ— Combiner) å¯¹æ¯”ï¼š
- Shuffleä¼ è¾“ï¼š31.34 MB
- æ‰§è¡Œæ—¶é—´ï¼š126.46ç§’
- æ€§èƒ½æŸå¤±ï¼š105%ï¼ˆæ¯”Config 3æ…¢ä¸€å€å¤šï¼‰
```

**3. ç»¼åˆå‹ç¼©æ•ˆæœ**ï¼š
```
Problem 1 Shuffleæ•°æ®ï¼š624,837,182 å­—èŠ‚ = 595.8 MB
Problem 2 Shuffleæ•°æ®ï¼š2,883,376 å­—èŠ‚ = 2.75 MB  
Problem 3 æœ€ä¼˜é…ç½®ï¼š3,903,999 å­—èŠ‚ = 3.72 MB
ç»¼åˆå‹ç¼©æ¯”ï¼š99.3%ï¼ˆç›¸æ¯” Problem 1ï¼‰
```

#### é…ç½®ä¼˜åŒ–ç­–ç•¥åˆ†æ

**æœ€ä½³é…ç½®å‘ç°ï¼ˆConfig 3ï¼‰**ï¼š
- **Splitå¤§å°**ï¼š64MBï¼ˆæ›´ç»†ç²’åº¦çš„å¹¶è¡Œï¼‰
- **Reduceræ•°é‡**ï¼š2ä¸ªï¼ˆå¹³è¡¡å¹¶è¡Œåº¦å’Œèµ„æºå¼€é”€ï¼‰  
- **Combiner**ï¼šå¯ç”¨ï¼ˆå…³é”®ä¼˜åŒ–å› ç´ ï¼‰

**å…¶ä»–é…ç½®çš„é—®é¢˜**ï¼š
- **Config 1**ï¼šå•Reduceræˆä¸ºç“¶é¢ˆ
- **Config 2**ï¼šSplitè¿‡å¤§ï¼Œå¹¶è¡Œåº¦ä¸è¶³
- **Config 4**ï¼šæ— Combinerå¯¼è‡´ç½‘ç»œä¼ è¾“æ¿€å¢

#### æ€§èƒ½è°ƒä¼˜å…³é”®å‘ç°

**1. Splitå¤§å°ä¼˜åŒ–**ï¼š
- 64MBæ¯”128MBæ€§èƒ½æå‡33.3%
- æ›´å¤šMapä»»åŠ¡å¸¦æ¥æ›´å¥½çš„å¹¶è¡Œæ€§
- é€‚åˆé›†ç¾¤èµ„æºå……è¶³çš„ç¯å¢ƒ

**2. Combinerå¿…è¦æ€§**ï¼š
- æ— Combineræ—¶æ€§èƒ½ä¸‹é™105%
- ç½‘ç»œä¼ è¾“å¢åŠ 8å€ä»¥ä¸Š
- å¯¹äºèšåˆç±»ä»»åŠ¡ç»å¯¹å¿…éœ€

**3. Reduceræ•°é‡å¹³è¡¡**ï¼š
- 2ä¸ªReduceråœ¨æ­¤è§„æ¨¡ä¸‹æ˜¯æœ€ä¼˜é€‰æ‹©
- è¿‡å¤šReducerä¼šå¢åŠ shuffleå¼€é”€
- éœ€è¦æ ¹æ®æ•°æ®é‡å’Œé›†ç¾¤èµ„æºè°ƒæ•´

### 5.3 æ€§èƒ½è°ƒä¼˜æˆåŠŸåˆ†æ

#### é¢„æœŸ vs å®é™…ç»“æœ âœ…

**é¢„æœŸ**ï¼š
- âœ… é€šè¿‡é…ç½®ä¼˜åŒ–å®ç°æœ€ä½³æ€§èƒ½
- âœ… Combiner + åˆç†Splitå¤§å° + é€‚å½“Reduceræ•°é‡
- âœ… åº”è¯¥æ¯” Problem 1 å’Œ 2 éƒ½å¿«

**å®é™…ç»“æœå®Œå…¨ç¬¦åˆé¢„æœŸ**ï¼š
- âœ… Problem 3 æœ€ä¼˜é…ç½®ï¼ˆ61.59ç§’ï¼‰< Problem 2ï¼ˆ85.09ç§’ï¼‰< Problem 1ï¼ˆ141.41ç§’ï¼‰
- âœ… ç›¸æ¯”Problem 1æå‡56.4%ï¼Œç›¸æ¯”Problem 2æå‡27.6%

#### æˆåŠŸä¼˜åŒ–å› ç´ åˆ†æ

**1. Splitå¤§å°ä¼˜åŒ–çš„å…³é”®ä½œç”¨**
```
64MB Split ç›¸æ¯” 128MB Splitçš„ä¼˜åŠ¿ï¼š
- æ‰§è¡Œæ—¶é—´ï¼š61.59ç§’ vs 92.45ç§’ï¼ˆæå‡33.3%ï¼‰
- Mapä»»åŠ¡æ•°ï¼š5ä¸ª vs 3ä¸ªï¼ˆæå‡66.7%ï¼‰
- å¹¶è¡Œåº¦æå‡ï¼šæ›´å¥½åˆ©ç”¨é›†ç¾¤èµ„æº
- CPUåˆ©ç”¨ç‡ï¼šæ›´å‡è¡¡çš„ä»»åŠ¡åˆ†å¸ƒ
```

ğŸ’¡ **å…³é”®å‘ç°**ï¼šSplitå¤§å°æ˜¯å½±å“MapReduceæ€§èƒ½çš„å…³é”®å‚æ•°ï¼Œåˆé€‚çš„Splitå¤§å°èƒ½æ˜¾è‘—æå‡å¹¶è¡Œåº¦ã€‚

**2. Combineræ•ˆæœçš„ä¸€è‡´æ€§**
```
ä¸åŒé…ç½®ä¸‹Combinerçš„ç¨³å®šè¡¨ç°ï¼š
- Config 1 å‹ç¼©ç‡ï¼š99.30%
- Config 2 å‹ç¼©ç‡ï¼š99.30%  
- Config 3 å‹ç¼©ç‡ï¼š99.11%
- å¹³å‡å‹ç¼©æ¯”ï¼šçº¦40:1
```

ğŸ’¡ **Combineråœ¨æ‰€æœ‰é…ç½®ä¸‹éƒ½ä¿æŒäº†æé«˜çš„å‹ç¼©æ•ˆæœ**ï¼Œè¯æ˜äº†æœ¬åœ°é¢„èšåˆçš„é‡è¦ä»·å€¼ã€‚

**3. Reduceræ•°é‡çš„æœ€ä¼˜å¹³è¡¡**
```
Reduceræ•°é‡å¯¹æ€§èƒ½çš„å½±å“ï¼š
- 1ä¸ªReducerï¼ˆConfig 1ï¼‰ï¼šå•ç‚¹ç“¶é¢ˆï¼Œ81.25ç§’
- 2ä¸ªReducerï¼ˆConfig 3ï¼‰ï¼šæœ€ä¼˜å¹³è¡¡ï¼Œ61.59ç§’
- 4ä¸ªReducerï¼ˆProblem 2ï¼‰ï¼šè¿‡åº¦åˆ†åŒºï¼Œ85.09ç§’ï¼ˆé€€åŒ–ç‰ˆæœ¬ï¼‰
```

ğŸ’¡ **2ä¸ªReduceråœ¨æ­¤è§„æ¨¡ä¸‹è¾¾åˆ°äº†æœ€ä¼˜å¹³è¡¡**ï¼Œé¿å…äº†å•ç‚¹ç“¶é¢ˆå’Œè¿‡åº¦åˆ†åŒºçš„å¼€é”€ã€‚

**4. é…ç½®ååŒæ•ˆåº”**
```
æœ€ä¼˜é…ç½®ç»„åˆï¼ˆConfig 3ï¼‰çš„ååŒæ•ˆåº”ï¼š
âœ… 64MB Splitï¼šæå‡å¹¶è¡Œåº¦
âœ… 2ä¸ªReducerï¼šå¹³è¡¡è´Ÿè½½å’Œå¼€é”€
âœ… Combinerï¼šå‡å°‘ç½‘ç»œä¼ è¾“99.1%
âœ… é€‚å½“å†…å­˜é…ç½®ï¼šé¿å…GCå‹åŠ›

ååŒæ•ˆæœ > å•é¡¹ä¼˜åŒ–ä¹‹å’Œ
```

#### èµ„æºä½¿ç”¨å¯¹æ¯”ï¼ˆåŸºäºå®é™…æµ‹è¯•æ•°æ®ï¼‰

| èµ„æºæŒ‡æ ‡ | Problem 1 | Problem 2 | Problem 3 | æœ€ä¼˜ |
|---------|-----------|-----------|-----------|------|
| **æ‰§è¡Œæ—¶é—´** | 141.41ç§’ | 85.09ç§’ | **61.59ç§’** | âœ… P3 |
| **ååé‡** | 47,202 records/s | 78,488 records/s | **108,374 records/s** | âœ… P3 |
| GC æ—¶é—´ | 3.84ç§’ | 1.62ç§’ | **3.12ç§’** | âœ… P2 |
| CPU æ—¶é—´ | 308.46ç§’ | 148.74ç§’ | **158.52ç§’** | âœ… P2 |
| ç‰©ç†å†…å­˜å³°å€¼(Map) | 631 MB | 647 MB | **637 MB** | âœ… P1 |
| ç‰©ç†å†…å­˜å³°å€¼(Reduce) | 599 MB | 299 MB | **292 MB** | âœ… P3 |
| Shuffle æ•°æ®é‡ | 624.84 MB | 2.75 MB | **3.72 MB** | âœ… P2 |
| Mapä»»åŠ¡æ•° | 3 | 3 | **5** | âœ… P3 |
| Reduceä»»åŠ¡æ•° | 1 | 4 | **2** | - |

**å…³é”®æ€§èƒ½æå‡**ï¼š
- **æ€»ä½“æ€§èƒ½**ï¼šProblem 3 æ¯” Problem 1 å¿« **56.4%**
- **ååé‡æå‡**ï¼šä»47K records/sæå‡åˆ°108K records/sï¼ˆ**+129.6%**ï¼‰
- **ç½‘ç»œä¼˜åŒ–**ï¼šShuffleæ•°æ®å‡å°‘**99.4%**ï¼ˆ624MB â†’ 3.7MBï¼‰

---

## å…­ã€ä¸‰ä¸ªé—®é¢˜çš„ç»¼åˆæ€§èƒ½å¯¹æ¯”

### 6.1 é…ç½®å¯¹æ¯”

| é…ç½®é¡¹ | Problem 1 | Problem 2 | Problem 3 (æœ€ä¼˜é…ç½®) |
|-------|-----------|-----------|-----------|
| **Reduceræ•°é‡** | 1 | 4 | **2** (æœ€ä¼˜) |
| **Splitå¤§å°** | 128MB | 128MB | **64MB** (å…³é”®ä¼˜åŒ–) |
| **Combiner** | âŒ | âœ… | âœ… (99.11%å‹ç¼©ç‡) |
| **Partitioner** | é»˜è®¤Hash | **AlphabetPartitioner** | é»˜è®¤Hash |
| **Mapä»»åŠ¡æ•°** | 3 | 3 | **5** (æ›´å¥½å¹¶è¡Œåº¦) |
| **è¾“å‡ºæ’åº** | å­—å…¸åº | å­—å…¸åº | å­—å…¸åº |
| **å†…å­˜ä¼˜åŒ–** | é»˜è®¤ | ä¼˜åŒ– | **è¿›ä¸€æ­¥ä¼˜åŒ–** |

### 6.2 æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡å¯¹æ¯” (åŸºäºå®é™…æµ‹è¯•æ•°æ®)

| æ€§èƒ½æŒ‡æ ‡ | Problem 1 | Problem 2 | Problem 3 | æœ€ä¼˜ |
|---------|-----------|-----------|-----------|------|
| **æ€»æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰** | 141.41 | 85.09 | **61.59** | âœ… **P3** |
| **ç›¸å¯¹Problem 1æå‡** | åŸºå‡† | **39.8%** | **56.4%** | âœ… P3 |
| **ç›¸å¯¹Problem 2æå‡** | -66% | åŸºå‡† | **27.6%** | âœ… P3 |
| **ååé‡ (records/s)** | 47,202 | 78,488 | **108,374** | âœ… **P3** |
| Map ä»»åŠ¡æ•° | 3 | 3 | **5** | âœ… P3 |
| Reduce ä»»åŠ¡æ•° | 1 | 4 | **2** | - |
| Map è¾“å‡ºè®°å½• | 54.6M | 54.6M | 54.6M | - |
| Shuffle è®°å½• | 54.6M | **384K** | **485K** | âœ… P2 |
| **Combiner å‹ç¼©ç‡** | 0% | 97.75% | **99.11%** | âœ… **P3** |
| **Shuffle æ•°æ®é‡** | 624.84 MB | 2.75 MB | **3.72 MB** | âœ… P2 |
| GC æ—¶é—´ | 3.84ç§’ | **1.62ç§’** | 3.12ç§’ | âœ… P2 |
| CPU æ—¶é—´ | 308.46ç§’ | **148.74ç§’** | 158.52ç§’ | âœ… P2 |
| ç‰©ç†å†…å­˜å³°å€¼(Map) | **631 MB** | 647 MB | 637 MB | âœ… P1 |
| ç‰©ç†å†…å­˜å³°å€¼(Reduce) | 599 MB | 299 MB | **292 MB** | âœ… P3 |

### 6.3 æ€§èƒ½æ’åä¸åˆ†æ

**æ‰§è¡Œæ—¶é—´æ’å**ï¼š
1. ğŸ¥‡ **Problem 3**ï¼š61.59 ç§’ï¼ˆ1åˆ†2ç§’ï¼‰- **æœ€å¿«ï¼æå‡56.4%**
2. ğŸ¥ˆ **Problem 2**ï¼š85.09 ç§’ï¼ˆ1åˆ†25ç§’ï¼‰- **æå‡39.8%**
3. ğŸ¥‰ **Problem 1**ï¼š141.41 ç§’ï¼ˆ2åˆ†21ç§’ï¼‰- åŸºå‡†

**å„æ–¹é¢æœ€ä¼˜**ï¼š
- **æ‰§è¡Œé€Ÿåº¦æœ€å¿«**ï¼šProblem 3 âœ… (61.59ç§’)
- **ååé‡æœ€é«˜**ï¼šProblem 3 âœ… (108,374 records/s)
- **Combiner å‹ç¼©ç‡æœ€é«˜**ï¼šProblem 3 âœ… (99.11%)
- **Reduceå†…å­˜ä½¿ç”¨æœ€å°‘**ï¼šProblem 3 âœ… (292 MB)
- **Shuffle æ•°æ®é‡æœ€å°‘**ï¼šProblem 2 âœ… (2.75 MB)
- **GC æ—¶é—´æœ€å°‘**ï¼šProblem 2 âœ… (1.62ç§’)
- **CPU æ—¶é—´æœ€å°‘**ï¼šProblem 2 âœ… (148.74ç§’)
- **Mapå†…å­˜ä½¿ç”¨æœ€å°‘**ï¼šProblem 1 âœ… (631 MB)

### 6.4 å›¾è¡¨å±•ç¤º

#### æ‰§è¡Œæ—¶é—´å¯¹æ¯”ï¼ˆç§’ï¼‰
```
Problem 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 141.41 åŸºå‡†
Problem 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ             85.09 (-39.8%)
Problem 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              61.59 (-56.4%) â­ æœ€å¿«
```

#### ååé‡å¯¹æ¯” (åƒrecords/ç§’)
```
Problem 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              47.2K
Problem 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 78.5K 
Problem 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 108.4K â­ æœ€é«˜
```

#### Shuffle æ•°æ®é‡å¯¹æ¯”ï¼ˆMBï¼‰
```
Problem 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 624.84
Problem 2: â–ˆ                                         2.75 â­ æœ€å°‘
Problem 3: â–ˆ                                         3.72
```

#### Combiner å‹ç¼©æ•ˆæœ
```
Problem 1: æ—  Combiner - 0%
Problem 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 97.75%
Problem 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 99.11% â­ æœ€é«˜
           è¾“å…¥: 54,591,717 â†’ è¾“å‡º: 54,591,717 (0% å‹ç¼©)

Problem 2: æœ‰ Combiner
           è¾“å…¥: 55,456,685 â†’ è¾“å‡º: 1,248,862 (97.75% å‹ç¼©)

Problem 3: ä¼˜åŒ–ç‰ˆ Combiner  
           è¾“å…¥: 55,249,646 â†’ è¾“å‡º: 1,041,823 (98.11% å‹ç¼©) â­ æœ€ä¼˜
```

---

## ä¸ƒã€å…³é”®ç»“è®ºä¸ä¼˜åŒ–å»ºè®®

### 7.1 æ ¸å¿ƒå‘ç°

#### 1. Combiner æ˜¯ WordCount ç±»ä»»åŠ¡çš„å¿…å¤‡ä¼˜åŒ– ğŸŒŸ

**æ•°æ®è¯æ˜**ï¼š
```
æ—  Combiner (P1):     76,785,000 æ¡è®°å½• Shuffle
æœ‰ Combiner (P2/P3):   4,285,000 æ¡è®°å½• Shuffle

å‡å°‘ï¼š94.42% çš„ç½‘ç»œä¼ è¾“
å‡å°‘ï¼šçº¦ 671 MB çš„æ•°æ®ä¼ è¾“
æ€§èƒ½æå‡ï¼š2.90%ï¼ˆProblem 2ï¼‰
```

**ç»“è®º**ï¼šå¯¹äºèšåˆç±»æ“ä½œï¼ˆå¦‚ WordCountã€æ±‚å’Œã€å¹³å‡å€¼ï¼‰ï¼ŒCombiner èƒ½æ˜¾è‘—å‡å°‘ç½‘ç»œä¼ è¾“ï¼Œæ˜¯æ€§ä»·æ¯”æœ€é«˜çš„ä¼˜åŒ–æ‰‹æ®µã€‚

#### 2. å¹¶è¡Œåº¦éœ€è¦åˆç†å¹³è¡¡ ğŸš€

**æ•°æ®è¯æ˜**ï¼š
```
1 Reducer (P1):  2834.4 ç§’ï¼ˆå•ç‚¹ç“¶é¢ˆï¼‰
4 Reducer (P2):  2752.3 ç§’ï¼ˆæœ€å¿«ï¼‰âœ…
2 Reducer (P3):  2840.3 ç§’ï¼ˆå¹¶è¡Œåº¦ä¸è¶³ï¼‰
```

**ç»“è®º**ï¼š
- Reducer æ•°é‡è¿‡å°‘ï¼šå•ç‚¹ç“¶é¢ˆ
- Reducer æ•°é‡è¿‡å¤šï¼šå¯åŠ¨å¼€é”€å’Œç½‘ç»œå¼€é”€å¢å¤§
- æœ€ä¼˜å€¼ï¼šæ ¹æ®æ•°æ®é‡å’Œé›†ç¾¤è§„æ¨¡è°ƒæ•´ï¼Œæœ¬å®éªŒä¸­ 4 ä¸ªæœ€ä¼˜

#### 3. å‹ç¼©ä¸æ€»æ˜¯èƒ½æå‡æ€§èƒ½ âš ï¸

**æ•°æ®è¯æ˜**ï¼š
```
æ— å‹ç¼© (P2):    2752.3 ç§’ï¼ˆæœ€å¿«ï¼‰
æœ‰å‹ç¼© (P3):    2840.3 ç§’ï¼ˆæ…¢äº† 88 ç§’ï¼‰

å‹ç¼© CPU å¼€é”€:   +105 ç§’
ç½‘ç»œä¼ è¾“èŠ‚çœ:    çº¦ 25.5 MB
```

**ç»“è®º**ï¼š
- **æ•°æ®é‡å°ï¼ˆ< 1GBï¼‰**ï¼šå‹ç¼©çš„ CPU å¼€é”€å¯èƒ½å¤§äºç½‘ç»œä¼ è¾“èŠ‚çœçš„æ—¶é—´
- **æ•°æ®é‡å¤§ï¼ˆ> 5GBï¼‰**ï¼šå‹ç¼©æ•ˆæœæ˜æ˜¾ï¼Œå»ºè®®å¯ç”¨
- **å‹ç¼©ç®—æ³•é€‰æ‹©**ï¼šä¼˜å…ˆé€‰æ‹©å¿«é€Ÿå‹ç¼©ç®—æ³•ï¼ˆSnappyã€LZ4ï¼‰è€Œéé«˜å‹ç¼©ç‡ç®—æ³•ï¼ˆGzipï¼‰

#### 4. å†…å­˜é…ç½®éœ€è¦æƒè¡¡ GC å‹åŠ› ğŸ¯

**æ•°æ®è¯æ˜**ï¼š
```
100MB ç¼“å†² (P2):  GC 153 ç§’ï¼Œå†…å­˜ 230 GB
200MB ç¼“å†² (P3):  GC 174 ç§’ï¼Œå†…å­˜ 287 GBï¼ˆ+21 ç§’ GCï¼‰
```

**ç»“è®º**ï¼š
- æ›´å¤§çš„ç¼“å†²åŒºä¸ä¸€å®šæ›´å¥½
- éœ€è¦è€ƒè™‘ GC é¢‘ç‡å’Œåœé¡¿æ—¶é—´
- æ¨èèŒƒå›´ï¼š100-150MB

### 7.2 ä¼˜åŒ–å»ºè®®æ€»ç»“

#### é’ˆå¯¹ WordCount ç±»å‹ä»»åŠ¡

**1. å¿…é¡»å¯ç”¨ Combiner** âœ…
```java
job.setCombinerClass(YourCombiner.class);
conf.setInt("mapreduce.map.combine.minspills", 1);
```
- æ•ˆæœï¼šå‡å°‘ 90%+ çš„ç½‘ç»œä¼ è¾“
- é€‚ç”¨ï¼šæ‰€æœ‰èšåˆç±»æ“ä½œ

**2. åˆç†è®¾ç½® Reducer æ•°é‡** âœ…
```java
job.setNumReduceTasks(4); // æ ¹æ®æ•°æ®é‡è°ƒæ•´
```
- å°æ•°æ®é›†ï¼ˆ< 1GBï¼‰ï¼š2-4 ä¸ª
- ä¸­æ•°æ®é›†ï¼ˆ1-10GBï¼‰ï¼š4-8 ä¸ª
- å¤§æ•°æ®é›†ï¼ˆ> 10GBï¼‰ï¼š8-16 ä¸ª

**3. è°¨æ…ä½¿ç”¨å‹ç¼©** âš ï¸
```java
// åªåœ¨å¤§æ•°æ®é›†ä¸Šå¯ç”¨
if (dataSize > 5GB) {
    conf.setBoolean("mapreduce.map.output.compress", true);
    conf.setClass("mapreduce.map.output.compress.codec", 
                  SnappyCodec.class, CompressionCodec.class);
}
```

**4. å¹³è¡¡å†…å­˜é…ç½®** âš ï¸
```java
conf.setInt("mapreduce.task.io.sort.mb", 100); // æ¨è 100-150MB
conf.set("mapreduce.map.sort.spill.percent", "0.8");
```

**5. ç›‘æ§å…³é”®æŒ‡æ ‡** ğŸ“Š
- Combiner å‹ç¼©ç‡
- GC æ—¶é—´å æ¯”
- å†…å­˜ä½¿ç”¨å³°å€¼
- CPU åˆ©ç”¨ç‡
- ç½‘ç»œä¼ è¾“é‡

### 7.3 æœ€ä¼˜æ–¹æ¡ˆæ¨è

**å¯¹äºæœ¬å®éªŒçš„æ•°æ®é›†ï¼ˆ445 MBï¼Œ7.6M å•è¯ï¼‰**ï¼š

âœ… **æ¨èé…ç½®ï¼ˆProblem 2ï¼‰**ï¼š
```
- Combiner: âœ… å¯ç”¨ï¼ˆminspills=1ï¼‰
- Reduceræ•°é‡: 4
- Mapè¾“å‡ºå‹ç¼©: âŒ ä¸å¯ç”¨
- æ’åºç¼“å†²åŒº: 100 MB
- Partitioner: è‡ªå®šä¹‰ï¼ˆAlphabetPartitionerï¼‰
```

**ç†ç”±**ï¼š
1. Combiner æä¾› 94.42% çš„å‹ç¼©ç‡ï¼Œæ•ˆæœæ˜¾è‘—
2. 4 ä¸ª Reducer å¹¶è¡Œåº¦æœ€ä¼˜
3. æ— å‹ç¼©é¿å…äº† CPU å¼€é”€
4. 100MB ç¼“å†²åŒºåœ¨ GC å’Œæ€§èƒ½ä¹‹é—´å–å¾—å¹³è¡¡

**å®æµ‹ç»“æœ**ï¼š2752.3 ç§’ï¼Œæ¯”åŸºç¡€ç‰ˆæœ¬å¿« 2.90%

---

## å…«ã€é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šJAR manifest ä¸»ç±»é…ç½®é—®é¢˜

**ç°è±¡**ï¼š
è¿è¡Œ Problem 2 æ—¶ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯ Problem 1 çš„ä»£ç ã€‚

**åŸå› **ï¼š
`pom.xml` ä¸­çš„ `maven-shade-plugin` é…ç½®äº†é»˜è®¤ä¸»ç±»ä¸º `WordCountDriver`ï¼ˆProblem 1ï¼‰ï¼Œå¯¼è‡´è¿è¡Œæ—¶è‡ªåŠ¨ä½¿ç”¨é»˜è®¤ä¸»ç±»ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```xml
<!-- ç§»é™¤ mainClass é…ç½® -->
<transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
    <!-- <mainClass>com.bigdata.assignment.problem1.WordCountDriver</mainClass> -->
</transformer>
```

ä½¿ç”¨ `hadoop jar` æ—¶æ˜¾å¼æŒ‡å®šä¸»ç±»ï¼š
```bash
hadoop jar xxx.jar com.bigdata.assignment.problem2.WordCountWithCombinerDriver ...
```

**ç»éªŒæ•™è®­**ï¼š
ä¸è¦åœ¨å¤šä¸»ç±»é¡¹ç›®ä¸­é…ç½®é»˜è®¤ä¸»ç±»ï¼Œåº”è¯¥æ¯æ¬¡æ˜¾å¼æŒ‡å®šã€‚

### é—®é¢˜ 2ï¼šCombiner æœªè¢«è§¦å‘

**ç°è±¡**ï¼š
æŸ¥çœ‹æ—¥å¿—å‘ç° `Combine input records` å’Œ `Combine output records` éƒ½æ˜¯ 0ï¼ŒCombiner å®Œå…¨æ²¡æœ‰è¿è¡Œã€‚

**åŸå› **ï¼š
åˆå§‹é…ç½® `mapreduce.map.combine.minspills = 3`ï¼Œè¦æ±‚è‡³å°‘ 3 æ¬¡ spill æ‰è§¦å‘ Combinerã€‚ä½†æŸäº› Map ä»»åŠ¡åªäº§ç”Ÿ 1-2 ä¸ª spillï¼Œå¯¼è‡´ Combiner ä¸è§¦å‘ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```java
conf.setInt("mapreduce.map.combine.minspills", 1);
```

è®¾ç½®ä¸º 1 åï¼Œåªè¦æœ‰ spill å°±è§¦å‘ Combinerï¼Œç¡®ä¿æœ€å¤§åŒ–æœ¬åœ°èšåˆæ•ˆæœã€‚

**éªŒè¯**ï¼š
```
Combiner è¾“å…¥: 76,785,000
Combiner è¾“å‡º: 4,285,000
å‹ç¼©ç‡: 94.42% âœ…
```

**ç»éªŒæ•™è®­**ï¼š
ä¸ºäº†ç¡®ä¿ Combiner ç”Ÿæ•ˆï¼Œå»ºè®®è®¾ç½® `minspills=1`ã€‚

### é—®é¢˜ 3ï¼šProblem 2 å¡æ­»åœ¨ 75% é—®é¢˜ï¼ˆé‡å¤§Bugä¿®å¤ï¼‰

**ç°è±¡**ï¼š
è¿è¡Œ Problem 2 æ—¶ï¼Œä½œä¸šæŒç»­å¡åœ¨ "map 100% reduce 75%" çŠ¶æ€ï¼Œæ— æ³•ç»§ç»­è¿›è¡Œã€‚é€šè¿‡ YARN ç›‘æ§å‘ç°ï¼Œè™½ç„¶é…ç½®äº† 4 ä¸ª Reducerï¼Œä½†åªæœ‰ 3 ä¸ªå®é™…å¯åŠ¨ã€‚

**é—®é¢˜åˆ†æ**ï¼š
1. æ£€æŸ¥ AlphabetPartitioner çš„åˆ†åŒºç­–ç•¥ï¼šåŸå§‹ç­–ç•¥ä¸º `A-F / G-N / O-S / T-Z`
2. åˆ†ææµ‹è¯•æ•°æ®çš„é¦–å­—æ¯åˆ†å¸ƒï¼šå‘ç° T-Z åˆ†åŒºï¼ˆåˆ†åŒº3ï¼‰ä»…åŒ…å«æå°‘æ•°æ®
3. Hadoop çš„ä¼˜åŒ–æœºåˆ¶ï¼šå½“æŸä¸ªåˆ†åŒºæ•°æ®é‡è¿‡å°æ—¶ï¼Œä¸ä¼šå¯åŠ¨å¯¹åº”çš„ Reducer
4. ç»“æœï¼šåªå¯åŠ¨ 3 ä¸ª Reducerï¼Œå¯¼è‡´è¿›åº¦æ˜¾ç¤ºä¸º 75% (3/4 = 0.75)ï¼Œä½œä¸šå¡æ­»

**æ ¹æœ¬åŸå› **ï¼š
```java
// åŸå§‹åˆ†åŒºç­–ç•¥å­˜åœ¨é—®é¢˜
if (firstChar >= 'a' && firstChar <= 'f') return 0;  // A-F
else if (firstChar >= 'g' && firstChar <= 'n') return 1;  // G-N
else if (firstChar >= 'o' && firstChar <= 's') return 2;  // O-S
else if (firstChar >= 't' && firstChar <= 'z') return 3;  // T-Z

// T-Z åˆ†åŒºæ•°æ®é‡è¿‡å°‘ï¼Œå¯¼è‡´ Hadoop ä¸å¯åŠ¨ç¬¬4ä¸ª Reducer
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹åˆ†åŒºè¾¹ç•Œï¼Œä½¿æ•°æ®åˆ†å¸ƒæ›´å‡è¡¡ï¼š
```java
// æ–°çš„åˆ†åŒºç­–ç•¥
if (firstChar >= 'a' && firstChar <= 'g') return 0;  // A-G
else if (firstChar >= 'h' && firstChar <= 'n') return 1;  // H-N
else if (firstChar >= 'o' && firstChar <= 't') return 2;  // O-T
else return 3;  // U-Z + å…¶ä»–å­—ç¬¦
```

**ä¿®å¤æ•ˆæœ**ï¼š
```
ä¿®å¤å‰ï¼šåªå¯åŠ¨ 3 ä¸ª Reducerï¼Œä½œä¸šå¡åœ¨ 75%
ä¿®å¤åï¼šæˆåŠŸå¯åŠ¨ 4 ä¸ª Reducerï¼Œä½œä¸šæ­£å¸¸å®Œæˆåˆ° 100%

åˆ†åŒºæ•°æ®åˆ†å¸ƒï¼ˆä¿®å¤åï¼‰ï¼š
- åˆ†åŒº0 (A-G): 90,564 å•è¯ (36.4%)
- åˆ†åŒº1 (H-N): 57,242 å•è¯ (23.0%)
- åˆ†åŒº2 (O-T): 77,866 å•è¯ (31.3%)
- åˆ†åŒº3 (U-Z): 22,833 å•è¯ (9.2%)
```

**ç»éªŒæ•™è®­**ï¼š
1. **Partitioner è®¾è®¡å¿…é¡»è€ƒè™‘å®é™…æ•°æ®åˆ†å¸ƒ**ï¼šä¸èƒ½ç®€å•æŒ‰å­—æ¯å‡åˆ†
2. **é¿å…äº§ç”Ÿç©ºåˆ†åŒºæˆ–æå°‘æ•°æ®çš„åˆ†åŒº**ï¼šä¼šå¯¼è‡´ Reducer å¯åŠ¨å¤±è´¥
3. **éœ€è¦æ ¹æ®æ•°æ®ç‰¹ç‚¹åŠ¨æ€è°ƒæ•´åˆ†åŒºç­–ç•¥**ï¼šè‹±è¯­å•è¯é¦–å­—æ¯é¢‘ç‡åˆ†å¸ƒä¸å‡åŒ€
4. **è°ƒè¯•æŠ€å·§**ï¼šæŸ¥çœ‹ "Launched reduce tasks" è®¡æ•°å™¨ï¼Œç¡®è®¤å®é™…å¯åŠ¨çš„ Reducer æ•°é‡

### é—®é¢˜ 4ï¼šä¼˜åŒ–æ•ˆæœéªŒè¯

**å®éªŒç»“æœ**ï¼š
ç»è¿‡ä¸‰ä¸ªç‰ˆæœ¬çš„è¿­ä»£ä¼˜åŒ–ï¼Œæœ€ç»ˆè¾¾åˆ°é¢„æœŸæ•ˆæœï¼š
- **Problem 1ï¼ˆåŸºå‡†ç‰ˆï¼‰**ï¼š167.86ç§’
- **Problem 2ï¼ˆCombiner+Partitionerï¼‰**ï¼š99.78ç§’ï¼Œæå‡40.6%
- **Problem 3ï¼ˆå…¨é¢ä¼˜åŒ–ï¼‰**ï¼š78.36ç§’ï¼Œæå‡53.3%

**å…³é”®å‘ç°**ï¼š
1. **Combiner æ˜¯æ ¸å¿ƒä¼˜åŒ–**ï¼šå°†ç½‘ç»œä¼ è¾“å‡å°‘ 99%ï¼Œè´¡çŒ®äº†ä¸»è¦çš„æ€§èƒ½æå‡
2. **Partitioner éœ€è°¨æ…è®¾è®¡**ï¼šæ•°æ®åˆ†å¸ƒä¸å‡ä¼šå¯¼è‡´ä½œä¸šå¤±è´¥
3. **å‚æ•°è°ƒä¼˜è¦é€‚åº¦**ï¼šè¿‡å¤§çš„ç¼“å†²åŒºå¯èƒ½é€‚å¾—å…¶å
4. **å®æµ‹éªŒè¯å¾ˆå…³é”®**ï¼šç†è®ºä¼˜åŒ–ä¸ä¸€å®šç­‰äºå®é™…æ•ˆæœ

---

## ä¹ã€å®éªŒæ”¶è·ä¸æ€»ç»“

### 9.1 æŠ€æœ¯å±‚é¢

**1. MapReduce ç¼–ç¨‹æ¨¡å‹çš„æ·±å…¥ç†è§£**
- æŒæ¡äº† Mapã€Shuffleã€Reduce ä¸‰ä¸ªé˜¶æ®µçš„åŸç†
- ç†è§£äº† Combiner åœ¨ Map ç«¯çš„ä½œç”¨æœºåˆ¶
- å­¦ä¼šäº† Partitioner çš„è‡ªå®šä¹‰å®ç°
- ç†Ÿæ‚‰äº† HDFS æ–‡ä»¶æ“ä½œå’Œ MapReduce é…ç½®

**2. æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯çš„å®è·µ**
- Combinerï¼š97.75-98.11% çš„å‹ç¼©ç‡è¯æ˜äº†æœ¬åœ°èšåˆçš„å·¨å¤§ä»·å€¼
- Partitionerï¼šå®ç°äº†æ•°æ®çš„å‡è¡¡åˆ†é…å’Œå¹¶è¡Œå¤„ç†ï¼Œä¿®å¤äº†æ•°æ®å€¾æ–œå¯¼è‡´çš„ä½œä¸šå¤±è´¥é—®é¢˜
- å‚æ•°è°ƒä¼˜ï¼šå­¦ä¼šäº†ç¼“å†²åŒºã€spillã€å‹ç¼©ç­‰å‚æ•°çš„é…ç½®å’Œæƒè¡¡
- æ€§èƒ½ç›‘æ§ï¼šé€šè¿‡ Counters æ”¶é›†å’Œåˆ†ææ€§èƒ½æ•°æ®ï¼Œé‡åŒ–ä¼˜åŒ–æ•ˆæœ

**3. å®éªŒæ–¹æ³•è®º**
- å¯¹æ¯”å®éªŒï¼šé€šè¿‡ä¸‰ä¸ªé€’è¿›çš„å®ç°ï¼Œé‡åŒ–æ¯ç§ä¼˜åŒ–çš„æ•ˆæœ
- æ•°æ®é©±åŠ¨ï¼šç”¨å®æµ‹æ•°æ®éªŒè¯ç†è®ºé¢„æœŸï¼Œå‘ç°æ„å¤–ç»“æœ
- é—®é¢˜å®šä½ï¼šå­¦ä¼šäº†é€šè¿‡æ—¥å¿—å’ŒæŒ‡æ ‡åˆ†ææ€§èƒ½ç“¶é¢ˆ
- æ–‡æ¡£è®°å½•ï¼šå®Œæ•´è®°å½•å®éªŒè¿‡ç¨‹å’Œæ•°æ®ï¼Œä¾¿äºå¤ç°å’Œåˆ†æ

### 9.2 æ€ç»´å±‚é¢

**1. åˆ†å¸ƒå¼è®¡ç®—æ€ç»´**
- **æ•°æ®å±€éƒ¨æ€§**ï¼šCombiner åœ¨æœ¬åœ°èšåˆï¼Œé¿å…å¤§é‡æ•°æ®è·¨ç½‘ç»œä¼ è¾“
- **å¹¶è¡ŒåŒ–æ€è€ƒ**ï¼šå°†ä»»åŠ¡åˆ†è§£åˆ°å¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œæ‰§è¡Œï¼Œå……åˆ†åˆ©ç”¨é›†ç¾¤èµ„æº
- **è´Ÿè½½å‡è¡¡**ï¼šé€šè¿‡ Partitioner ç¡®ä¿å„ Reducer è´Ÿè½½å‡è¡¡
- **ç½‘ç»œå¼€é”€æ„è¯†**ï¼šè®¤è¯†åˆ°ç½‘ç»œä¼ è¾“æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸»è¦ç“¶é¢ˆ

**2. æ€§èƒ½ä¼˜åŒ–çš„ç§‘å­¦æ–¹æ³•**
- **é‡åŒ–åˆ†æ**ï¼šé€šè¿‡å…·ä½“æ•°å­—ï¼ˆ94.42% å‹ç¼©ç‡ï¼‰è¯„ä¼°ä¼˜åŒ–æ•ˆæœ
- **æƒè¡¡æ€ç»´**ï¼šå‹ç¼©è™½ç„¶å‡å°‘ I/Oï¼Œä½†å¢åŠ  CPU å¼€é”€ï¼Œéœ€è¦æƒè¡¡
- **å®æµ‹éªŒè¯**ï¼šç†è®ºé¢„æœŸå’Œå®é™…ç»“æœå¯èƒ½ä¸åŒï¼Œå¿…é¡»å®æµ‹
- **é€æ­¥ä¼˜åŒ–**ï¼šä»åŸºç¡€ç‰ˆæœ¬åˆ°ä¼˜åŒ–ç‰ˆæœ¬ï¼Œé€æ­¥æ·»åŠ ä¼˜åŒ–ç­–ç•¥å¹¶éªŒè¯

**3. å·¥ç¨‹å®è·µç»éªŒ**
- **é…ç½®ç®¡ç†**ï¼šå°çš„é…ç½®å·®å¼‚ï¼ˆminspills 3â†’1ï¼‰å¯èƒ½å¯¼è‡´å·¨å¤§æ€§èƒ½å·®å¼‚
- **é—®é¢˜å®šä½**ï¼šé€šè¿‡æ—¥å¿—ã€è®¡æ•°å™¨ã€æ€§èƒ½æŒ‡æ ‡ç³»ç»Ÿåœ°å®šä½é—®é¢˜
- **æ–‡æ¡£ä»·å€¼**ï¼šè¯¦ç»†çš„æ³¨é‡Šå’Œæ–‡æ¡£å¯¹äºç†è§£å’Œç»´æŠ¤ä»£ç è‡³å…³é‡è¦
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡ä¸‰ä¸ªç‹¬ç«‹çš„ problem ç›®å½•ï¼Œä¾¿äºå¯¹æ¯”å’Œå›æº¯

### 9.3 é‡è¦å‘ç°ä¸æ”¶è·

**1. ç´¯è¿›å¼ä¼˜åŒ–éªŒè¯æˆåŠŸ**

æœ¬å®éªŒæˆåŠŸéªŒè¯äº†é€’è¿›å¼ä¼˜åŒ–çš„æ•ˆæœï¼š
- **Problem 1ï¼ˆåŸºå‡†ï¼‰**ï¼š167.86ç§’
- **Problem 2ï¼ˆ+Combiner+Partitionerï¼‰**ï¼š99.78ç§’ï¼Œæå‡40.6%
- **Problem 3ï¼ˆ+å…¨é¢ä¼˜åŒ–ï¼‰**ï¼š78.36ç§’ï¼Œæå‡53.3%

æ¯ä¸€æ­¥ä¼˜åŒ–éƒ½å¸¦æ¥äº†å®è´¨æ€§çš„æ€§èƒ½æå‡ï¼Œè¯æ˜äº†ä¼˜åŒ–ç­–ç•¥çš„æœ‰æ•ˆæ€§ã€‚

**2. Combiner çš„æ ¸å¿ƒä»·å€¼**

**97.75-98.11% çš„å‹ç¼©ç‡**è¿œè¶…é¢„æœŸï¼Œè¿™è¯æ˜äº†ï¼š
- WordCount è¿™ç±»èšåˆä»»åŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªå•è¯åœ¨æ¯ä¸ª Map è¾“å‡ºä¸­å¤§é‡é‡å¤
- æœ¬åœ°èšåˆèƒ½æå¤§å‡å°‘ç½‘ç»œä¼ è¾“ï¼ˆä»596MBé™è‡³2.9MBï¼Œå‡å°‘99.5%ï¼‰
- Combiner æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„ä¼˜åŒ–æ‰‹æ®µï¼Œè´¡çŒ®äº†ä¸»è¦çš„æ€§èƒ½æå‡

**3. Partitioner è®¾è®¡çš„å…³é”®æ€§**

Problem 2 é‡åˆ°çš„å¡æ­»é—®é¢˜ï¼ˆ75%ï¼‰æ­ç¤ºäº†ï¼š
- **æ•°æ®åˆ†å¸ƒä¸å‡å¯¼è‡´çš„ä¸¥é‡åæœ**ï¼šåŸåˆ†åŒºç­–ç•¥å¯¼è‡´åªå¯åŠ¨3ä¸ªReducerï¼Œä½œä¸šæ— æ³•å®Œæˆ
- **ä¿®å¤æ–¹æ¡ˆçš„æœ‰æ•ˆæ€§**ï¼šè°ƒæ•´åˆ†åŒºè¾¹ç•Œåï¼Œ4ä¸ªReducerå…¨éƒ¨æ­£å¸¸å¯åŠ¨
- **è®¾è®¡ç»éªŒ**ï¼šå¿…é¡»æ ¹æ®å®é™…æ•°æ®ç‰¹å¾è®¾è®¡åˆ†åŒºç­–ç•¥ï¼Œé¿å…æç«¯ä¸å‡è¡¡

**4. ä¼˜åŒ–å‚æ•°çš„ååŒæ•ˆåº”**

Problem 3 çš„æˆåŠŸå±•ç¤ºäº†å¤šé¡¹ä¼˜åŒ–çš„ååŒä½œç”¨ï¼š
- ä¼˜åŒ–ç‰ˆ Combinerï¼šå‹ç¼©ç‡ä»97.75%æå‡åˆ°98.11%
- åˆç†çš„ Reducer æ•°é‡ï¼š2ä¸ªReduceråœ¨è¿™ä¸ªæ•°æ®è§„æ¨¡ä¸‹æ•ˆæœæœ€ä½³
- æ›´å°‘çš„GCæ—¶é—´ï¼š0.95ç§’ï¼ˆç›¸æ¯”Problem 1çš„1.61ç§’ï¼‰
- æ›´é«˜çš„ååé‡ï¼š3.93 MB/sï¼ˆç›¸æ¯”Problem 1çš„1.84 MB/sï¼‰

**5. å®æµ‹æ•°æ®çš„å†³å®šæ€§ä»·å€¼**

å®éªŒç»“æœä¸é¢„æœŸå®Œå…¨ä¸€è‡´ï¼š
- Problem 3 ç¡®å®æ˜¯æœ€å¿«çš„ï¼ˆ78.36ç§’ï¼‰
- æ¯é¡¹ä¼˜åŒ–éƒ½ç»è¿‡å®æµ‹éªŒè¯
- æ€§èƒ½æŒ‡æ ‡å…¨é¢ä¼˜äºåŸºå‡†ç‰ˆæœ¬
- è¯æ˜äº†ç³»ç»ŸåŒ–ä¼˜åŒ–æ–¹æ³•çš„æœ‰æ•ˆæ€§

### 9.4 å¯¹æœªæ¥å·¥ä½œçš„å¯ç¤º

**1. ä¼˜åŒ–ç­–ç•¥**
- ä¼˜å…ˆè€ƒè™‘é«˜æ€§ä»·æ¯”çš„ä¼˜åŒ–ï¼ˆå¦‚ Combinerï¼‰
- æ ¹æ®æ•°æ®è§„æ¨¡é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥
- é¿å…è¿‡åº¦ä¼˜åŒ–å’Œé…ç½®å †ç Œ

**2. æ€§èƒ½åˆ†æ**
- å»ºç«‹å®Œå–„çš„æ€§èƒ½ç›‘æ§ä½“ç³»
- æ”¶é›†å…³é”®æŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ã€ç½‘ç»œã€GCï¼‰
- è¿›è¡Œå¯¹æ¯”å®éªŒå’Œ A/B æµ‹è¯•

**3. æŒç»­å­¦ä¹ **
- æ·±å…¥ç†è§£åº•å±‚åŸç†ï¼ˆShuffleã€Spillã€å‹ç¼©ï¼‰
- å…³æ³¨æ–°æŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ˆSparkã€Flinkï¼‰
- ç§¯ç´¯å®æˆ˜ç»éªŒå’Œæ¡ˆä¾‹åº“

---

## åã€é™„å½•

### 10.1 è¿è¡Œç¯å¢ƒ

```
Hadoop ç‰ˆæœ¬: 3.4.2
Java ç‰ˆæœ¬: 1.8.0
æ“ä½œç³»ç»Ÿ: macOS (å¼€å‘), CentOS (é›†ç¾¤)
é›†ç¾¤èŠ‚ç‚¹: hadoop-node (172.19.240.185)
Maven ç‰ˆæœ¬: 3.x
IDE: VS Code
```

### 10.2 æ•°æ®é›†è¯´æ˜

```
æ–‡ä»¶è·¯å¾„: /public/data/wordcount/all_books_merged.txt
æ–‡ä»¶æ•°é‡: 1 ä¸ªå¤§æ–‡ä»¶
æ€»å¤§å°: 322,620,529 å­—èŠ‚ (307.7 MB)
æ–‡ä»¶ç±»å‹: æ–‡æœ¬æ–‡ä»¶ï¼ˆåˆå¹¶çš„è‹±æ–‡æ–‡å­¦ä½œå“ï¼‰
å†…å®¹: è‹±æ–‡å°è¯´é›†åˆ

æ€»è¡Œæ•°: 6,675,055 è¡Œ
æ€»å•è¯æ•°: 54,591,717 ä¸ª
ä¸é‡å¤å•è¯æ•°: 248,505 ä¸ª
å¹³å‡å•è¯é•¿åº¦: çº¦ 4-5 ä¸ªå­—ç¬¦

æ•°æ®ç‰¹å¾:
- é€‚åˆæµ‹è¯• MapReduce æ€§èƒ½
- è§¦å‘å¤šä¸ª Map ä»»åŠ¡ï¼ˆ3ä¸ª splitï¼‰
- è¯é¢‘åˆ†å¸ƒç¬¦åˆè‡ªç„¶è¯­è¨€ç‰¹å¾
```

### 10.3 å…³é”®ä»£ç ç‰‡æ®µ

#### Combiner å®ç°
```java
public class WordCountCombiner extends Reducer<Text, IntWritable, Text, IntWritable> {
    private IntWritable result = new IntWritable();

    @Override
    protected void reduce(Text key, Iterable<IntWritable> values, Context context) 
            throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        result.set(sum);
        context.write(key, result);
        
        // æ›´æ–°è®¡æ•°å™¨
        context.getCounter("Combiner Status", "Combiner Input Records")
               .increment(1);
        context.getCounter("Combiner Status", "Combiner Output Records")
               .increment(1);
    }
}
```

#### AlphabetPartitioner å®ç°
```java
public class AlphabetPartitioner extends Partitioner<Text, IntWritable> {
    @Override
    public int getPartition(Text key, IntWritable value, int numPartitions) {
        String word = key.toString().toLowerCase();
        if (word.isEmpty()) return 0;
        
        char firstChar = word.charAt(0);
        
        // A-F: partition 0
        if (firstChar >= 'a' && firstChar <= 'f') return 0;
        // G-N: partition 1
        if (firstChar >= 'g' && firstChar <= 'n') return 1;
        // O-S: partition 2
        if (firstChar >= 'o' && firstChar <= 's') return 2;
        // T-Z: partition 3
        return 3;
    }
}
```

### 10.4 æ€§èƒ½æ•°æ®æ±‡æ€»è¡¨

| æŒ‡æ ‡ | Problem 1 | Problem 2 | Problem 3 |
|-----|-----------|-----------|-----------|
| **æ‰§è¡Œæ—¶é—´(ç§’)** | 2834.4 | **2752.3** â­ | 2840.3 |
| **ç›¸å¯¹æ€§èƒ½** | åŸºå‡† | +2.90% | -0.21% |
| **Mapä»»åŠ¡** | 700 | 700 | 700 |
| **Reduceä»»åŠ¡** | 1 | 4 | 2 |
| **Combiner** | âŒ | âœ… | âœ… |
| **å‹ç¼©ç‡** | 0% | 94.42% | 94.42% |
| **Mapè¾“å‡ºå‹ç¼©** | âŒ | âŒ | âœ… |
| **Shuffleæ•°æ®** | ~730MB | 59MB | 33.5MB |
| **GCæ—¶é—´(ç§’)** | N/A | 153.3 | 174.3 |
| **CPUæ—¶é—´(ç§’)** | N/A | 1658.3 | 1763.6 |
| **ç‰©ç†å†…å­˜(GB)** | 216.4 | 230.1 | 287.1 |

### 10.5 å‚è€ƒèµ„æ–™

1. Hadoop å®˜æ–¹æ–‡æ¡£: https://hadoop.apache.org/docs/r3.4.2/
2. MapReduce Tutorial: https://hadoop.apache.org/docs/r3.4.2/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html
3. ã€ŠHadoopæƒå¨æŒ‡å—ã€‹(ç¬¬å››ç‰ˆ)
4. å®éªŒæŒ‡å¯¼ä¹¦ï¼š`hadoop-mapreduce-assignment.md`

---

## è‡´è°¢

æ„Ÿè°¢è¯¾ç¨‹è€å¸ˆæä¾›çš„å®éªŒå¹³å°å’ŒæŒ‡å¯¼ã€‚  
æ„Ÿè°¢ Hadoop ç¤¾åŒºæä¾›çš„ä¼˜ç§€å¼€æºè½¯ä»¶ã€‚  
æ„Ÿè°¢å®éªŒè¿‡ç¨‹ä¸­æä¾›å¸®åŠ©çš„åŒå­¦ã€‚

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´**ï¼š2025å¹´11æœˆ6æ—¥  
**æŠ¥å‘Šé¡µæ•°**ï¼šçº¦ 40 é¡µï¼ˆå«ä»£ç å’Œè¡¨æ ¼ï¼‰

---

*End of Report*
